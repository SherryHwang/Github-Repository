C51 COMPILER V9.56.0.0   PCF8591                                                           07/24/2018 01:07:00 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE PCF8591
OBJECT MODULE PLACED IN .\Objects\PCF8591.obj
COMPILER INVOKED BY: D:\Software\C51\C51\BIN\C51.EXE PCF8591\PCF8591.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\IIC;.\LCD1602;.
                    -\DELAY;.\PCF8591;.\SENSOR) DEBUG OBJECTEXTEND PRINT(.\Listings\PCF8591.lst) TABS(2) OBJECT(.\Objects\PCF8591.obj)

line level    source

   1          #include "PCF8591.h"
   2          #include "IIC.h"
   3          bit ack2;
   4          void Set_Channels(uchar n)  //读第几通道的数据
   5          {
   6   1        switch(n)
   7   1        {
   8   2          case 0:
   9   2            ISendByte(PCF8591,0x40);  //设置通道0
  10   2            break;
  11   2          case 1:
  12   2            ISendByte(PCF8591,0x41);  //设置通道1
  13   2            break;
  14   2          case 2:
  15   2            ISendByte(PCF8591,0x42);  //设置通道2
  16   2            break;
  17   2          case 3:
  18   2            ISendByte(PCF8591,0x43);  //设置通道3
  19   2            break;
  20   2          default:
  21   2            ISendByte(PCF8591,0x40);  //默认设置通道0 
  22   2        }
  23   1      }
  24          bit DACconversion(unsigned char sla,unsigned char c,  unsigned char Val)  
  25          {
  26   1         Start_I2c();              //启动总线
  27   1         SendByte(sla);            //发送器件地址
  28   1         if(ack2==0)return(0);
  29   1         SendByte(c);              //发送控制字节
  30   1         if(ack2==0)return(0);
  31   1         SendByte(Val);            //发送DAC的数值  
  32   1         if(ack2==0)return(0);
  33   1         Stop_I2c();               //结束总线
  34   1         return(1);
  35   1      }
  36          
  37          bit ISendByte(unsigned char sla,unsigned char c)
  38          {
  39   1         Start_I2c();              //启动总线
  40   1         SendByte(sla);            //发送器件地址
  41   1         if(ack2==0)return(0);
  42   1         SendByte(c);              //发送数据
  43   1         if(ack2==0)return(0);
  44   1         Stop_I2c();               //结束总线
  45   1         return(1);
  46   1      }
  47          uchar IRcvByte(unsigned char sla)
  48          {
  49   1         uchar c;
  50   1         Start_I2c();          //启动总线
  51   1         SendByte(sla+1);      //发送器件地址
  52   1         if(ack2==0)return(0);
  53   1         c=RcvByte();          //读取数据0
  54   1         Ack_I2c(1);           //发送非就答位
C51 COMPILER V9.56.0.0   PCF8591                                                           07/24/2018 01:07:00 PAGE 2   

  55   1         Stop_I2c();           //结束总线
  56   1         return(c);
  57   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    144    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       7
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
